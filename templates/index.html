
{% extends "base.html" %}

{% block content %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
    <h1 style="text-align: center;">Bienvenido {{ current_user.username }}!</h1>
    <div style="margin-bottom: 10px; text-align: center;">
        <img src="{{ url_for('static', filename='imgs/Logo.jpeg') }}" alt="Logo Supermercado Williams" style="height: 240px; border-radius: 8px; display: inline-block;">
    </div>
    <div style="text-align: center;">
        <p class="bienvenida-super">Supermercado Williams, tu supermercado virtual favorito.</p>
    </div>

    {% if mostrar_promos %}
    <h2 style="text-align: center;">Promociones</h2>
    <div class="product-list">
        {% for product in productos %}
            <div class="product-card">
                {% if product.seccion %}
                    <div style="position: relative;">
                        <div class="promo-label">{{ product.seccion }}</div>
                        {% if product.imagen %}
                            <img src="{{ url_for('static', filename='imgs/' + product.imagen) }}" alt="{{ product.nombre }}">
                        {% else %}
                            <img src="{{ url_for('static', filename='images/default_product.png') }}" alt="{{ product.nombre }}">
                        {% endif %}
                    </div>
                {% else %}
                    {% if product.imagen %}
                        <img src="{{ url_for('static', filename='imgs/' + product.imagen) }}" alt="{{ product.nombre }}">
                    {% else %}
                        <img src="{{ url_for('static', filename='images/default_product.png') }}" alt="{{ product.nombre }}">
                    {% endif %}
                {% endif %}
                <h3>{{ product.nombre }}</h3>
                <p>
                    <span class="old-price">${{ '%.2f'|format(product.precio) }}</span>
                    <span class="discount-price">${{ '%.2f'|format(product.precio_descuento) }}</span>
                    <span class="discount-label">-{{ product.descuento|int }}%</span>
                </p>
                <form action="{{ url_for('product_detail', product_id=product.id) }}" method="post">
                    {{ form.hidden_tag() }}
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit">Agregar al Carrito</button>
                </form>
            </div>
        {% endfor %}
    </div>
    {% else %}
    <h2 style="text-align: center;">Productos Destacados</h2>
    <div class="product-list">
        {% for product in productos %}
            <div class="product-card">
                {% if product.image_url %}
                    <img src="{{ url_for('static', filename='imgs/' + product.image_url) }}" alt="{{ product.name }}">
                {% else %}
                    <img src="{{ url_for('static', filename='images/default_product.png') }}" alt="{{ product.name }}">
                {% endif %}
                <h3><a href="{{ url_for('product_detail', product_id=product.id) }}">{{ product.name }}</a></h3>
                <p>${{ "%.2f"|format(product.price) }}</p>
                <p>Stock: {{ product.stock }}</p>
                <form action="{{ url_for('product_detail', product_id=product.id) }}" method="post">
                    {{ form.hidden_tag() }}
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit">Agregar al Carrito</button>
                </form>
            </div>
        {% endfor %}
    </div>
    {% endif %}
{% endblock %}