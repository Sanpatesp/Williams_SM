{% extends "base.html" %}

{% block content %}
    <h1>Bienvenido {{ current_user.username }}!</h1>
    <div style="margin-bottom: 10px;">
        <img src="{{ url_for('static', filename='imgs/Logo.jpeg') }}" alt="Logo Supermercado Williams" style="height: 120px; border-radius: 8px; display: block;">
    </div>
    <div>
        <p>Supermercado Williams, tu supermercado virtual favorito.</p>
    </div>

    {% if mostrar_promos %}
    <h2>Promociones</h2>
    <div class="product-list">
        {% for product in productos %}
            <div class="product-card">
                {% if product.imagen %}
                    <img src="{{ url_for('static', filename='imgs/' + product.imagen) }}" alt="{{ product.nombre }}">
                {% else %}
                    <img src="{{ url_for('static', filename='images/default_product.png') }}" alt="{{ product.nombre }}">
                {% endif %}
                <h3>{{ product.nombre }}</h3>
                <p>
                    <span style="text-decoration: line-through; color: #888;">${{ '%.2f'|format(product.precio) }}</span>
                    <span style="color: #d32f2f; font-weight: bold;">${{ '%.2f'|format(product.precio_descuento) }}</span>
                    <span style="color: #388e3c;">-{{ product.descuento|int }}%</span>
                </p>
                <form action="{{ url_for('product_detail', product_id=product.id) }}" method="post">
                    {{ form.hidden_tag() }}
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit">Agregar al Carrito</button>
                </form>
            </div>
        {% endfor %}
    </div>
    {% else %}
    <h2>Productos Destacados</h2>
    <div class="product-list">
        {% for product in productos %}
            <div class="product-card">
                {% if product.image_url %}
                    <img src="{{ url_for('static', filename='imgs/' + product.image_url) }}" alt="{{ product.name }}">
                {% else %}
                    <img src="{{ url_for('static', filename='images/default_product.png') }}" alt="{{ product.name }}">
                {% endif %}
                <h3><a href="{{ url_for('product_detail', product_id=product.id) }}">{{ product.name }}</a></h3>
                <p>${{ "%.2f"|format(product.price) }}</p>
                <p>Stock: {{ product.stock }}</p>
                <form action="{{ url_for('product_detail', product_id=product.id) }}" method="post">
                    {{ form.hidden_tag() }}
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit">Agregar al Carrito</button>
                </form>
            </div>
        {% endfor %}
    </div>
    {% endif %}
{% endblock %}